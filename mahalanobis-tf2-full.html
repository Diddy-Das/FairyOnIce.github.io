<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>


   <!-- Global site tag (gtag.js) - Google Analytics -->
   <script async src="https://www.googletagmanager.com/gtag/js?id=UA-112020731-1"></script>
   <script>
   window.dataLayer = window.dataLayer || [];
   function gtag(){dataLayer.push(arguments);}
   gtag('js', new Date());

   gtag('config', 'UA-112020731-1');
   </script>

 

  <meta charset="utf-8">
  <title>Classification with Mahalanobis distance + full covariance using tensorflow</title>
  <meta name="author" content="Yumi">



  <!-- https://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="https://FairyOnIce.github.io/favicon.png" rel="icon">
  <link href="https://FairyOnIce.github.io/theme/css/main.css" media="screen, projection"
rel="stylesheet" type="text/css">
 <link rel="stylesheet" href="https://FairyOnIce.github.io/theme/tipuesearch.css">
  <script src="https://FairyOnIce.github.io/theme/js/modernizr-2.0.js"></script>
  <script src="https://FairyOnIce.github.io/theme/js/ender.js"></script>
  <script src="https://FairyOnIce.github.io/theme/js/octopress.js" type="text/javascript"></script>

  <link href="https://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
</head>

<body>
  <header role="banner"><hgroup>
  <h1><a href="https://FairyOnIce.github.io/">Yumi's Blog</a></h1>
</hgroup></header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
</ul>


<form action="https://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:FairyOnIce.github.io" />
    <input class="search" type="text" name="q" results="0"
placeholder="Google Search"/>
  </fieldset>
</form>

<ul class="main-navigation">
    <li><a href="/archives.html">Archives</a></li>
      <li><a href="https://FairyOnIce.github.io/pages/deployment.html">Deployment</a></li>
      <li><a href="https://FairyOnIce.github.io/pages/quest.html">Quest</a></li>
    <li class="active">
    <a href="https://FairyOnIce.github.io/category/blog.html">Blog</a>
    </li>
</ul></nav>
  <div id="main">
    <div id="content">
<div>
  <article class="hentry" role="article">
<header>
      <h1 class="entry-title">Classification with Mahalanobis distance + full covariance using tensorflow</h1>
      <p class="meta"><time datetime="2020-01-29T21:00:00-08:00" pubdate>Wed 29 January 2020</time></p>
</header>

  <div class="entry-content"><style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This blog discusses how to calculate Mahalanobis distance using tensorflow. 
I will consider full variance approach, i.e., each cluster has its own general covariance matrix, so I do not assume common variance accross clusters unlike the <a href="https://fairyonice.github.io/mahalanobis-tf2.html">previous post</a>.
Calculation of Mahalanobis distance is important for classification when each cluster has different covariance structure. 
Let's take a lookt at this situation using toy data.</p>
<p>Bonus: This blog post goes over how to use <a href="https://www.tensorflow.org/api_docs/python/tf/while_loop">tf.while_loop</a></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Example-Data">Example Data<a class="anchor-link" href="#Example-Data">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the following toy data, I generate 60 samples from 2-d Gaussian mixture model with three components: 20 samples from each of a 2-d gaussian.
Notice that each gaussian distribution has different variance matrix.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> 
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">N_CLUSTER</span>  <span class="o">=</span> <span class="mi">3</span> 
<span class="n">N_FEATURES</span> <span class="o">=</span> <span class="mi">2</span> 
<span class="n">_N</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">N_SAMPLE</span>  <span class="o">=</span> <span class="n">_N</span> <span class="o">*</span> <span class="n">N_CLUSTER</span>


<span class="n">S1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">N_FEATURES</span><span class="p">)</span>
<span class="n">S1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">S1</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">S2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">N_FEATURES</span><span class="p">)</span><span class="o">*</span><span class="mf">0.1</span>
<span class="n">S3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">N_FEATURES</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span>
<span class="n">S3</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">S3</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.8</span>

<span class="n">mu1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">])</span>
<span class="n">mu2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="n">mu3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="n">npMEANS</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">mu1</span><span class="p">,</span><span class="n">mu2</span><span class="p">,</span><span class="n">mu3</span><span class="p">])</span>
<span class="n">npSIGMAS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">S1</span><span class="p">,</span><span class="n">S2</span><span class="p">,</span><span class="n">S3</span><span class="p">])</span>

<span class="n">colors</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">"red"</span><span class="p">,</span><span class="s2">"green"</span><span class="p">,</span><span class="s2">"blue"</span><span class="p">])</span>
<span class="n">npX</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="k">for</span> <span class="n">icluster</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_CLUSTER</span><span class="p">):</span>
    <span class="n">color</span>     <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">icluster</span><span class="p">]</span>
    <span class="n">npmean</span>    <span class="o">=</span> <span class="n">npMEANS</span><span class="p">[</span><span class="n">icluster</span><span class="p">]</span>
    <span class="n">s_cluster</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">npmean</span><span class="p">,</span><span class="n">npSIGMAS</span><span class="p">[</span><span class="n">icluster</span><span class="p">],</span><span class="n">_N</span><span class="p">)</span>
    <span class="n">npX</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">s_cluster</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">npmean</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">npmean</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="s2">"X"</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">s_cluster</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">s_cluster</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s2">"p"</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">"cluster=</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">icluster</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Sample distribution from </span><span class="si">{}</span><span class="s2"> clusters"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">N_CLUSTER</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">GT</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">_N</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">_N</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">2</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">_N</span><span class="p">)]</span>
<span class="n">npX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">npX</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"npX:      Data Dimension = (N_SAMPLE,N_FEATURES)  = </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">npX</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"npMEANS:  Data Dimension = (N_CLUSTER,N_FEATURES) = </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">npMEANS</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"npSIGMAS: Data Dimension = (N_CLUSTER,N_FEATURES,N_FEATURES) = </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">npSIGMAS</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>

<span class="k">for</span> <span class="n">icluster</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_CLUSTER</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">***CLUSTER=</span><span class="si">{}</span><span class="s2">***"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">icluster</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">">>>MEAN"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">npMEANS</span><span class="p">[</span><span class="n">icluster</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">">>>SIGMA"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">npSIGMAS</span><span class="p">[</span><span class="n">icluster</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
9rfzUCJoaWnh6quvZu7cuZx99tnU1dUlfozgpqw1NUF1NaxYAW1t0f/V1dHtIjIwQwk+d+fw4f6/
mvmBBx5gypQp1NbWcsstt3DbbbcNtZi9Ci74li+HujqorIRJk6L/6+qi20VSI0/Nku9///ssXLiQ
U089leuuu67Lfeeff37njKpdu3bRMa103bp1nHXWWZx22mksXLiQTZs2cfvtt7N582ZOO+00br01
+laGe++9lzPPPJOFCxdy1113AVBXV8dJJ53En//5n3PGGWewbVt/318FP/7xj7n++usBWLJkCT/7
2c9IehWpgszVLaRMBvbvh44uAjMoK4Np/c7uExkmTU2wejW89hpMnhw1S048ERYvhvFDHyK7bt06
7r77blavXk0mk2H37t184xvf6PfvvvOd73DzzTdz7bXX0traSnt7O/fccw+vvvoqr7zyCgArV65k
06ZN/OpXv8LdueKKK3juueeorKxk48aNPPjgg501xKuvvpqNGzcecZy/+qu/4hOf+ATbt29n5szo
e7lGjRrFpEmTaGhoIJM54jvjhyy44Js3D7o/5s3NMHduYcojcoTly2HPnqg5YgYTJ0bNkr174cor
h7zbVatWsWTJks4AKS8vH9DfLVq0iLvvvpv6+no+9rGPMW/evCO2WblyJStXruT006OvF96/fz+b
Nm2isrKSWbNmcc4573ytyqOP9vQdW+/oqXaX9IWh4IJv+nQoL4f6+ndumzo1ul0kFfLULHH3PgNk
1KhRnX1w2UNFrrnmGs4++2x++tOfcvHFF/Pd736XE07o+gV57s4dd9zBjTfe2OX2uro6xnerpfZX
46uoqGDbtm1UVFTQ1tbG3r17BxzSAxVc8JWVwVVXFboUIn3IU7Pkoosu4qMf/Si33HILU6dOZffu
3V3unz17NmvWrOGss87iscce67x9y5YtnHDCCXz2s59ly5YtrF27llNPPZW33367c5uLL76YL3/5
y1x77bVMmDCB7du39zqror8a3xVXXMH3vvc9Fi1axGOPPcaFF16oGp9IyctTs2TBggXceeedvO99
72PkyJGcfvrpZK+L+YUvfIGrrrqKhx9+mAsvvLDz9kcffZSlS5dSVlbGsccey1//9V9TXl7O4sWL
Ofnkk7nkkku49957Wb9+PYsWLQJgwoQJLF26lJEjRw66nJ/5zGe47rrrmDt3LuXl5Sxbtiyn8+5J
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
" />
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>npX:      Data Dimension = (N_SAMPLE,N_FEATURES)  = (60, 2)
npMEANS:  Data Dimension = (N_CLUSTER,N_FEATURES) = (3, 2)
npSIGMAS: Data Dimension = (N_CLUSTER,N_FEATURES,N_FEATURES) = (3, 2, 2)

***CLUSTER=0***
>>>MEAN
[1 2]
>>>SIGMA
[[1. 0.]
 [0. 1.]]

***CLUSTER=1***
>>>MEAN
[-2 -2]
>>>SIGMA
[[0.1 0. ]
 [0.  0.1]]

***CLUSTER=2***
>>>MEAN
[-3  2]
>>>SIGMA
[[ 3.  -2.8]
 [-2.8  3. ]]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the plot above, the samples are colored with ground truth clusters. 
Due to the difference in variance matrix, the shape of each cluster is different!</p>
<pre><code>- red cluster: circle 
- blue cluster: high negatice correlation
- green cluster: circle, small variance 

</code></pre>
<p>If you use Euclidean distance, covariance matrix of each cluster is implicitly assumed to be the same (as an identity matrix) so many blue points in the bottom of the blue clusters are classified into the red cluster.</p>
<p>The script below shows this issue.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Euclidean-distance-based-classification-(numpy)">Euclidean distance based classification (numpy)<a class="anchor-link" href="#Euclidean-distance-based-classification-(numpy)">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The classification accuracy is 0.9.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.spatial</span> <span class="k">import</span> <span class="n">distance</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="n">npEuclidean</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npMEANS</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npX</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
<span class="k">for</span> <span class="n">isample</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npX</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">icluster</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npMEANS</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">npEuclidean</span><span class="p">[</span><span class="n">isample</span><span class="p">][</span><span class="n">icluster</span><span class="p">]</span> <span class="o">=</span> <span class="n">distance</span><span class="o">.</span><span class="n">euclidean</span><span class="p">(</span><span class="n">npX</span><span class="p">[</span><span class="n">isample</span><span class="p">],</span><span class="n">npMEANS</span><span class="p">[</span><span class="n">icluster</span><span class="p">])</span>
<span class="n">npEuclidean</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">npEuclidean</span><span class="p">)</span>

<span class="n">pred</span> <span class="o">=</span> <span class="n">npEuclidean</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">npX</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">npX</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">pred</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Classification using Euclidean distance acc=</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">GT</span> <span class="o">==</span> <span class="n">pred</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
rrU2u4cftl7bFStg3jxb/OeMM2zpubSZf9+1hoi8r6rDm7WtJz8XOV98AcOH164C5+fbMIsHHggv
LtdmLUl+Xu110XPttbagd7ySElvg+9tvw4nJpZwnPxc9H39s1d66cnPhq69SH48LhSc/Fz077FB/
ADNYaXCjjay38dVXgwc/uw7Dh7q46Dn/fOv0WL16/X0FBbD99rYYSXa2jf/LzYUXXoBf/CK8WF3S
eMnPRc+gQTZjyK67QlaWrbd53HHwwQfW9rdyJaxaBT/8APvvH3zVgWv3PPm5aBo2zNbbrKiwJJeX
Fzx9UmUlvPRS6uNzSefVXufArh0N6gRRtVlGmmv2bBtLuHChXZI1fnzwgt0udAkp+YnIASIyW0Tm
isiEROzTuZQ69FAb7FxXZSXsu2/z9vHcc9aZcvPNNmzmnHOsHXHlysTG6hKizclPRDKBW4ADgcHA
OBEZ3Nb9OpdShx5qc/zVzOIiYiW2CROgV6+mn19VBccfb1eR1PQSr11rJcC//z1pYbvWS0TJb0dg
rqrOU9Vy4GHgsATs17nUycyEF1+EO++0yTOPOsp6ev/85+Y9//PPgztGSkuTMheda7tEtPn1BhbF
/b0Y2KnuRiJyKnAqwCabbJKAwzqXYFlZNuHpuHEtf25RUXCbIUCnTm2LyyVFIkp+QWv51btgWFUn
qupwVR3eo0ePBBzWuTTSv79Ni193lufCQl/0KE0lIvktBvrG/d0HWJKA/TrXvjz1lE2PVVxst9xc
OOGE1pUkXdIlotr7HjBIRPoD3wBHAkclYL/OtS/9+tlsz9Onw9Kl1oHiTTxpq83JT1UrReQ3wEtA
JnC3qs5sc2TOtUcZGbDHHmFH4ZohIYOcVfUF4IVE7Ms551LBL29zzkWSJz/nXCR58nPORZInP+dc
JHnyc85Fkic/51wkefJzzkWSJz/nXCR58nPORZInP+dcJHnyc85Fkic/51wkefJzzkWSJz/nXCR5
8nPORZInP+dcJHnyc85Fkic/51wkefJzzkWSJz/nXCR58nPORZInP+dcJHnyc85Fkic/51wkefJz
zkWSJz/nXCR58nPORZInP+dcJHnyc85Fkic/51wkefJzzkWSJz/nXCR58nNt8vyc59nmtm3IvyKf
LW/ekic+fyLskJxrlqywA3Dt17Ozn+XXj/+aksoSAGb/OJtjnz6WsqoyjtrmqJCjc65xXvJzrXb+
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
gg==
" />
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Mahalanobis-distance-based-classification-(numpy)">Mahalanobis distance based classification (numpy)<a class="anchor-link" href="#Mahalanobis-distance-based-classification-(numpy)">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If you use mahalanobis distance to calcualte the distance between samples and cluster centers, classification performance improves to 0.98.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.spatial</span> <span class="k">import</span> <span class="n">distance</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="n">npMAHALANOBIS</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npMEANS</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npX</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
<span class="k">for</span> <span class="n">isample</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npX</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">icluster</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npMEANS</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">npMAHALANOBIS</span><span class="p">[</span><span class="n">isample</span><span class="p">][</span><span class="n">icluster</span><span class="p">]</span> <span class="o">=</span> <span class="n">distance</span><span class="o">.</span><span class="n">mahalanobis</span><span class="p">(</span><span class="n">npX</span><span class="p">[</span><span class="n">isample</span><span class="p">],</span><span class="n">npMEANS</span><span class="p">[</span><span class="n">icluster</span><span class="p">],</span>
                                                                <span class="n">VI</span><span class="o">=</span><span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">npSIGMAS</span><span class="p">[</span><span class="n">icluster</span><span class="p">]))</span>
<span class="n">npMAHALANOBIS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">npMAHALANOBIS</span><span class="p">)</span>

<span class="n">pred</span> <span class="o">=</span> <span class="n">npMAHALANOBIS</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">npX</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">npX</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">pred</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Classification using Mahalanobis distance, acc=</span><span class="si">{:3.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">GT</span> <span class="o">==</span> <span class="n">pred</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"npMAHALANOBIS"</span><span class="p">)</span>
<span class="n">npMAHALANOBIS</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/yumikondo/anaconda3/lib/python3.6/site-packages/scipy/linalg/basic.py:1321: RuntimeWarning: internal gelsd driver lwork query error, required iwork dimension not returned. This is likely the result of LAPACK bug 0038, fixed in LAPACK 3.2.2 (released July 21, 2010). Falling back to 'gelss' driver.
  x, resids, rank, s = lstsq(a, b, cond=cond, check_finite=False)
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>npMAHALANOBIS
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt output_prompt">Out[3]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>array([[ 1.80886884, 20.50794437,  9.87289163],
       [ 2.44530783, 23.4049362 , 11.44350799],
       [ 2.10780571, 18.11904241,  7.98912043],
       [ 0.96206913, 17.43996842,  7.73389073],
       [ 0.42337367, 16.6867373 ,  6.88705391],
       [ 1.46138974, 19.90831722,  8.88687686],
       [ 0.77070307, 17.64471867,  7.83949613],
       [ 0.55529553, 17.50455002,  7.64973936],
       [ 1.50809887, 18.60042218,  8.52829531],
       [ 0.90966528, 14.44753654,  5.6756414 ],
       [ 2.63533191, 14.78376952,  3.32954469],
       [ 1.13932386, 15.98354025,  6.72254601],
       [ 2.69573099, 18.50690896,  7.94438202],
       [ 0.19269571, 15.43185405,  6.22624559],
       [ 2.12330575, 22.46329734, 11.13544953],
       [ 0.40867542, 17.0651693 ,  7.25274973],
       [ 2.17064925,  9.24047182,  2.33160146],
       [ 0.38142871, 15.59128177,  6.10851391],
       [ 1.72027104, 21.20380045, 10.23947028],
       [ 0.49133392, 14.31748096,  5.35888769],
       [ 5.55818978,  1.76519525,  6.16364726],
       [ 4.8963245 ,  2.59169493,  4.75696051],
       [ 5.20772623,  0.67205241,  5.41809113],
       [ 5.06236096,  1.4744448 ,  5.14278905],
       [ 5.37264771,  1.62785893,  5.81281208],
       [ 5.08088469,  0.97547625,  5.17655799],
       [ 5.39642988,  1.28639583,  5.79483163],
       [ 4.89778468,  0.429258  ,  4.76177196],
       [ 4.91102675,  0.30969952,  4.78279185],
       [ 5.21292689,  0.73071586,  5.43689182],
       [ 5.21954574,  0.76254936,  5.45272851],
       [ 5.5923296 ,  1.90820819,  6.21039728],
       [ 5.06942627,  0.43921288,  5.08849233],
       [ 5.21627247,  1.69461325,  5.47728254],
       [ 5.16455747,  0.90878416,  5.35180415],
       [ 4.83168346,  0.7404118 ,  4.57555954],
       [ 5.12292219,  1.68018711,  5.07995302],
       [ 5.10217037,  0.79425667,  5.13045246],
       [ 5.31280939,  1.04563598,  5.65490645],
       [ 5.04569747,  0.31657468,  5.07777588],
       [ 2.42566847,  8.30881401,  1.47277375],
       [ 5.28772819, 15.4093536 ,  1.60526826],
       [ 6.71149929, 24.39395134,  2.41024695],
       [ 6.37024254, 21.16558702,  1.19243206],
       [ 2.37005382,  8.73988553,  1.50279061],
       [ 2.94217956, 11.70266824,  1.28721544],
       [ 4.09988693, 15.11363531,  0.99860016],
       [ 4.46137739, 15.88891474,  0.79135495],
       [ 3.50194497, 14.56219972,  1.78590136],
       [ 4.10338449, 14.15969423,  0.4215473 ],
       [ 8.12381008, 25.96984533,  2.3157528 ],
       [ 2.40604389,  8.21804927,  1.59808076],
       [ 1.95921587,  9.71997443,  2.27021625],
       [ 3.65513219,  9.81943601,  0.85426539],
       [ 7.76768041, 27.28381972,  2.42685601],
       [ 7.71646691, 26.63001481,  2.07573924],
       [ 2.11342027, 10.48309795,  2.09524648],
       [ 3.29608231, 12.04325452,  0.84602723],
       [ 5.87419015, 19.50540307,  0.95985125],
       [ 4.93863668, 17.76637109,  1.10795244]])</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I hope that you are convinced that Mahalanobis distance is more preferable especially when cluster shapes are different. 
Now, we will calculate the Mahalanobis distance with tensorflow!</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Tensorflow-calculation">Tensorflow calculation<a class="anchor-link" href="#Tensorflow-calculation">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Previously, <a href="https://fairyonice.github.io/mahalanobis-tf2.html">Calculate Mahalanobis distance with tensorflow 2.0</a> discussed how to utilize Euclidean distance function to compute Mahalanobis distance. The idea was to first decompose the inverse of variance matrix by Cholesky decomposition and standardize the samples. We will use codes from there.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following code calculates the Euclidean distances between two groups.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="k">def</span> <span class="nf">Euclidean</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>
        <span class="n">v</span>   <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">p1</span>  <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">v</span>   <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">B</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">p2</span>  <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">transpose_b</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="k">return</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
    
<span class="c1">## Sanity check    </span>
<span class="n">npA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">N_SAMPLE</span><span class="p">,</span><span class="n">N_FEATURES</span><span class="p">))</span>    
<span class="n">npB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">N_CLUSTER</span><span class="p">,</span><span class="n">N_FEATURES</span><span class="p">))</span>
<span class="n">tfA</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">npA</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s2">"float32"</span><span class="p">)</span>
<span class="n">tfB</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">npB</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s2">"float32"</span><span class="p">)</span>
<span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">sess</span><span class="p">:</span>
    <span class="n">tfE</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">Euclidean</span><span class="p">(</span><span class="n">tfA</span><span class="p">,</span><span class="n">tfB</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">tfE</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="n">N_SAMPLE</span><span class="p">,</span><span class="n">N_CLUSTER</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="k">import</span> <span class="n">cdist</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Average MSE=</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">tfE</span><span class="o">-</span><span class="n">cdist</span><span class="p">(</span><span class="n">npA</span><span class="p">,</span><span class="n">npB</span><span class="p">,</span><span class="n">metric</span><span class="o">=</span><span class="s2">"euclidean"</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/yumikondo/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:34: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Average MSE=1.0233338821564651e-13
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Convert-numpy-array-to-tensor-objects">Convert numpy array to tensor objects<a class="anchor-link" href="#Convert-numpy-array-to-tensor-objects">¶</a></h2><p>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I will keep:</p>
<ul>
<li>tfSinv_half: Cholesky decomposition of the inverse of the cluster-covariance matrix</li>
<li>tfMEANS: standardized cluster means. Standardization is done by the cholesky decomposition of the inverse of the cluster-covariance matrix</li>
<li>tfX: sampled ata</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_mu1_Sinv_half</span><span class="p">(</span><span class="n">mu1</span><span class="p">,</span><span class="n">S1</span><span class="p">):</span>
    <span class="n">Sinv</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">S1</span><span class="p">)</span>
    <span class="c1">#Sinv_half = np.linalg.cholesky(Sinv + 0.01*np.identity(Sinv.shape[0])) </span>
    <span class="n">Sinv_half</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cholesky</span><span class="p">(</span><span class="n">Sinv</span><span class="p">)</span>
    <span class="n">mu1_stand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">mu1</span><span class="p">,</span><span class="n">Sinv_half</span><span class="p">)</span>    
    <span class="k">return</span><span class="p">(</span><span class="n">mu1_stand</span><span class="p">,</span><span class="n">Sinv_half</span><span class="p">)</span>


<span class="n">npMEANS_stand</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">npSinv_half</span>   <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">icluster</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_CLUSTER</span><span class="p">):</span>
    <span class="n">mu_stand</span><span class="p">,</span><span class="n">Sinv_half</span> <span class="o">=</span> <span class="n">get_mu1_Sinv_half</span><span class="p">(</span><span class="n">npMEANS</span><span class="p">[</span><span class="n">icluster</span><span class="p">],</span> <span class="c1"># (N_FEATURES,)</span>
                                           <span class="n">npSIGMAS</span><span class="p">[</span><span class="n">icluster</span><span class="p">])</span> <span class="c1"># (N_FEATURES,N_FEATURES)</span>
    <span class="n">npMEANS_stand</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mu_stand</span><span class="p">)</span>
    <span class="n">npSinv_half</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Sinv_half</span><span class="p">)</span>
<span class="n">npMEANS_stand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">npMEANS_stand</span><span class="p">)</span>
<span class="n">npSinv_half</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">npSinv_half</span><span class="p">)</span>


<span class="n">tfSinv_half</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">npSinv_half</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s2">"float32"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"tfSinv_half:"</span><span class="p">,</span><span class="n">tfSinv_half</span><span class="o">.</span><span class="n">get_shape</span><span class="p">())</span>


<span class="n">tfMEANS</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">npMEANS_stand</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s2">"float32"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"tfMEANS:"</span><span class="p">,</span><span class="n">tfMEANS</span><span class="o">.</span><span class="n">get_shape</span><span class="p">())</span>


<span class="n">tfX</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="n">npX</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s2">"float32"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"tfX:"</span><span class="p">,</span><span class="n">tfX</span><span class="o">.</span><span class="n">get_shape</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>tfSinv_half: (3, 2, 2)
tfMEANS: (3, 2)
tfX: (60, 2)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example-of-tf.while_loop:-Simple-looping-with-indexing-within-the-loop">Example of tf.while_loop: Simple looping with indexing within the loop<a class="anchor-link" href="#Example-of-tf.while_loop:-Simple-looping-with-indexing-within-the-loop">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I will use  <a href="https://www.tensorflow.org/api_docs/python/tf/while_loop">tf.while_loop</a> to calcualte the Mahalanobis distance. 
Here I shows the example usage of the tf.while_loop.</p>
<p>The following code simply slice each standardized cluster mean 3 times and return the final standardized cluster mean.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">body</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tfMEANS</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">condition</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">i</span> <span class="o"><</span> <span class="n">N_CLUSTER</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N_FEATURES</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s2">"float32"</span><span class="p">)</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s2">"int32"</span><span class="p">)</span>

<span class="c1"># while_loop must be instantiated AFTER all the global variables are defined</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Looping N_CLUSTER=</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">N_CLUSTER</span><span class="p">))</span>
<span class="n">wl</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">while_loop</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span>
                   <span class="n">body</span><span class="p">,</span>
                   <span class="n">loop_vars</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="p">])</span>
<span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">sess</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">wl</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Looping N_CLUSTER=3
(3, array([-1.8225913,  1.1547005], dtype=float32))
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Looping-with-Euclidean-distance-function">Looping with Euclidean distance function<a class="anchor-link" href="#Looping-with-Euclidean-distance-function">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can modify the code above to compute the Mahalanobis distance between the first sample and each cluster center.
The code below returns the Mahalanobis distance between the first sample and the final cluster.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span> 
    
<span class="k">def</span> <span class="nf">body</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">out</span><span class="p">):</span>
    <span class="n">mu_stand</span>  <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">tfMEANS</span><span class="p">[</span><span class="n">i</span><span class="p">],(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>           <span class="c1">## (n_feat)  </span>
    <span class="n">Sinv_half</span> <span class="o">=</span> <span class="n">tfSinv_half</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="c1">## (n_feat, n_feat)</span>
    <span class="n">X_stand</span>   <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">tfXi</span><span class="p">,</span><span class="n">Sinv_half</span><span class="p">)</span> 
    <span class="n">out</span> <span class="o">=</span> <span class="n">Euclidean</span><span class="p">(</span><span class="n">X_stand</span><span class="p">,</span><span class="n">mu_stand</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">out</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">condition</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">i</span> <span class="o"><</span> <span class="n">N_CLUSTER</span>

<span class="n">INDEX_FIRST_SAMPLE</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">tfXi</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">tfX</span><span class="p">[</span><span class="n">INDEX_FIRST_SAMPLE</span><span class="p">],(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"the dimension of sample:"</span><span class="p">,</span><span class="n">tfXi</span><span class="o">.</span><span class="n">get_shape</span><span class="p">())</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="s2">"float32"</span><span class="p">)</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s2">"int32"</span><span class="p">)</span>

<span class="c1"># while_loop must be instantiated AFTER all the global variables are defined</span>

<span class="n">wl</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">while_loop</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span>
                   <span class="n">body</span><span class="p">,</span>
                   <span class="n">loop_vars</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="p">])</span>

<span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">sess</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">wl</span><span class="p">))</span>
    
<span class="nb">print</span><span class="p">(</span><span class="s2">"Mahalanobis distance between the 3rd cluster center and the first cluster mean (numpy) </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">npMAHALANOBIS</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>the dimension of sample: (1, 2)
(3, array([[9.872893]], dtype=float32))
Mahalanobis distance between the 3rd cluster center and the first cluster mean (numpy) 9.872891632237177
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Mahalanobis-distance-calculation">Mahalanobis distance calculation<a class="anchor-link" href="#Mahalanobis-distance-calculation">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Modify the function above to finally obtain the Mahalanobis distances between ALL samples and ALL cluster centers.</p>
<p>Please see the example in <a href="https://www.tensorflow.org/api_docs/python/tf/while_loop">tf.while_loop</a> to understand how to handle a shape invariance of the looping variables.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">EfficientMahalanobis</span><span class="p">(</span><span class="n">tfX</span><span class="p">,</span><span class="n">tfMEANS</span><span class="p">,</span><span class="n">tfSinv_half</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    tfX         : (N_SAMPLE, N_FEATURES)</span>
<span class="sd">    tfSinv_half : (N_CLUSTER, N_FEATURES,N_FEATURES)</span>
<span class="sd">    tfMEANS     : (N_CLUSTER, N_FEATURES)</span>
<span class="sd">    </span>
<span class="sd">    Global variables need to be defined. </span>
<span class="sd">        N_CLUSTER</span>
<span class="sd">        </span>
<span class="sd">    OUTPUT:</span>
<span class="sd">    </span>
<span class="sd">    Mdist : (N_SAMPLE,N_CLUSTER) </span>
<span class="sd">    </span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="nf">Euclidean</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">):</span>
        <span class="n">v</span>   <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">A</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">p1</span>  <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">v</span>   <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">B</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">p2</span>  <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">transpose_b</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="k">return</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">body</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">out</span><span class="p">):</span>
        <span class="n">mu_stand</span>  <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">tfMEANS</span><span class="p">[</span><span class="n">i</span><span class="p">],(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>           <span class="c1">## (n_feat)  </span>
        <span class="n">Sinv_half</span> <span class="o">=</span> <span class="n">tfSinv_half</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="c1">## (n_feat, n_feat)</span>
        <span class="n">X_stand</span>   <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">tfX</span><span class="p">,</span><span class="n">Sinv_half</span><span class="p">)</span> 
        <span class="n">euc</span>       <span class="o">=</span> <span class="n">Euclidean</span><span class="p">(</span><span class="n">X_stand</span><span class="p">,</span><span class="n">mu_stand</span><span class="p">)</span> <span class="c1"># (N_SAMPLE,1)</span>
        <span class="n">out</span>       <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="k">lambda</span> <span class="p">:</span> <span class="n">euc</span><span class="p">,</span> <span class="k">lambda</span> <span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">out</span><span class="p">,</span><span class="n">euc</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">out</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">condition</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">i</span> <span class="o"><</span> <span class="n">N_CLUSTER</span>


    <span class="n">i</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s2">"int32"</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="s2">"float32"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"out.get_shape()"</span><span class="p">,</span><span class="n">out</span><span class="p">)</span>
    <span class="c1"># while_loop must be instantiated AFTER all the global variables are defined</span>
    <span class="n">_ncluster</span><span class="p">,</span> <span class="n">Mdist</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">while_loop</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span>
                       <span class="n">body</span><span class="p">,</span>
                       <span class="n">loop_vars</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">out</span><span class="p">],</span>
                       <span class="n">shape_invariants</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">get_shape</span><span class="p">(),</span> 
                                         <span class="n">tf</span><span class="o">.</span><span class="n">TensorShape</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># N_SAMPLE </span>
                                                         <span class="kc">None</span><span class="p">])])</span> <span class="c1"># N_CLUSTER</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"_ncluster      "</span><span class="p">,</span><span class="n">_ncluster</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Mdist          "</span><span class="p">,</span><span class="n">Mdist</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">Mdist</span><span class="p">)</span>

<span class="n">Mdist</span> <span class="o">=</span> <span class="n">EfficientMahalanobis</span><span class="p">(</span><span class="n">tfX</span><span class="p">,</span><span class="n">tfMEANS</span><span class="p">,</span><span class="n">tfSinv_half</span><span class="p">)</span>
<span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">sess</span><span class="p">:</span>
     <span class="n">tfMAHALANOBIS</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">Mdist</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"tfMAHALANOBIS.shape"</span><span class="p">,</span><span class="n">tfMAHALANOBIS</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>    
<span class="n">tfMAHALANOBIS</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>out.get_shape() Tensor("ones_2:0", shape=(0, 0), dtype=float32)
_ncluster       Tensor("while_2/Exit:0", shape=(), dtype=int32)
Mdist           Tensor("while_2/Exit_1:0", shape=(?, ?), dtype=float32)
tfMAHALANOBIS.shape (60, 3)
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt output_prompt">Out[8]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>array([[ 1.8088686 , 20.507944  ,  9.872893  ],
       [ 2.4453077 , 23.404936  , 11.443509  ],
       [ 2.107806  , 18.119043  ,  7.98912   ],
       [ 0.96206915, 17.439968  ,  7.7338896 ],
       [ 0.42337447, 16.686737  ,  6.8870544 ],
       [ 1.4613898 , 19.908318  ,  8.886876  ],
       [ 0.7707028 , 17.644718  ,  7.839496  ],
       [ 0.55529493, 17.50455   ,  7.64974   ],
       [ 1.508099  , 18.60042   ,  8.5282955 ],
       [ 0.909665  , 14.4475355 ,  5.6756415 ],
       [ 2.6353319 , 14.78377   ,  3.3295443 ],
       [ 1.139324  , 15.98354   ,  6.7225456 ],
       [ 2.6957312 , 18.506908  ,  7.944382  ],
       [ 0.19269733, 15.431853  ,  6.226246  ],
       [ 2.1233056 , 22.463297  , 11.135449  ],
       [ 0.40867597, 17.065168  ,  7.2527504 ],
       [ 2.170649  ,  9.240472  ,  2.3316014 ],
       [ 0.38142985, 15.591281  ,  6.1085134 ],
       [ 1.7202713 , 21.203802  , 10.2394705 ],
       [ 0.49133426, 14.317481  ,  5.358888  ],
       [ 5.5581894 ,  1.7651972 ,  6.1636477 ],
       [ 4.896325  ,  2.591696  ,  4.75696   ],
       [ 5.2077265 ,  0.67204523,  5.418091  ],
       [ 5.062361  ,  1.4744425 ,  5.142789  ],
       [ 5.372648  ,  1.6278567 ,  5.8128123 ],
       [ 5.080885  ,  0.975476  ,  5.176558  ],
       [ 5.3964295 ,  1.2863964 ,  5.794832  ],
       [ 4.897785  ,  0.42926118,  4.761772  ],
       [ 4.9110265 ,  0.3097043 ,  4.782792  ],
       [ 5.212927  ,  0.7307194 ,  5.436893  ],
       [ 5.219546  ,  0.76254964,  5.4527287 ],
       [ 5.5923295 ,  1.9082062 ,  6.2103972 ],
       [ 5.069426  ,  0.43920565,  5.0884933 ],
       [ 5.2162724 ,  1.6946104 ,  5.477282  ],
       [ 5.1645575 ,  0.9087805 ,  5.3518043 ],
       [ 4.8316836 ,  0.74040693,  4.5755596 ],
       [ 5.1229224 ,  1.680187  ,  5.0799527 ],
       [ 5.10217   ,  0.7942569 ,  5.130453  ],
       [ 5.312809  ,  1.0456353 ,  5.654906  ],
       [ 5.0456977 ,  0.31659907,  5.0777755 ],
       [ 2.4256685 ,  8.308814  ,  1.4727737 ],
       [ 5.287729  , 15.409354  ,  1.6052685 ],
       [ 6.7114997 , 24.39395   ,  2.410247  ],
       [ 6.370243  , 21.165588  ,  1.1924319 ],
       [ 2.3700538 ,  8.739886  ,  1.5027907 ],
       [ 2.9421794 , 11.702669  ,  1.2872156 ],
       [ 4.099887  , 15.113636  ,  0.99860024],
       [ 4.461377  , 15.888915  ,  0.7913555 ],
       [ 3.501945  , 14.562199  ,  1.7859012 ],
       [ 4.1033845 , 14.159694  ,  0.4215471 ],
       [ 8.12381   , 25.969843  ,  2.3157535 ],
       [ 2.4060435 ,  8.218049  ,  1.5980806 ],
       [ 1.959216  ,  9.7199745 ,  2.2702162 ],
       [ 3.655132  ,  9.819436  ,  0.8542645 ],
       [ 7.76768   , 27.28382   ,  2.4268565 ],
       [ 7.716467  , 26.630013  ,  2.075739  ],
       [ 2.1134202 , 10.483098  ,  2.0952466 ],
       [ 3.2960823 , 12.043255  ,  0.84602755],
       [ 5.8741903 , 19.505404  ,  0.95985067],
       [ 4.938637  , 17.76637   ,  1.1079527 ]], dtype=float32)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"MSE between the tensorflow and numpy Mahalanobis calculations"</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">tfMAHALANOBIS</span> <span class="o">-</span> <span class="n">npMAHALANOBIS</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>MSE between the tensorflow and numpy Mahalanobis calculations 4.83147260130798e-12
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="4.-Check-its-classifiation-performance.">4. Check its classifiation performance.<a class="anchor-link" href="#4.-Check-its-classifiation-performance.">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pred</span> <span class="o">=</span> <span class="n">tfMAHALANOBIS</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">npX</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">npX</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">pred</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Classification using Mahalanobis distance, acc=</span><span class="si">{:3.2f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">GT</span> <span class="o">==</span> <span class="n">pred</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>
</div>
</div>
</div>
</div>

<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
</div>
    <footer>
<p class="meta">
  <span class="byline author vcard">
    Posted by <span class="fn">Yumi</span>
  </span>
<time datetime="2020-01-29T21:00:00-08:00" pubdate>Wed 29 January 2020</time>  <span class="categories">
    <a class="category" href="https://FairyOnIce.github.io/tag/computer-vision.html">Computer Vision</a>
  </span>
</p><div class="sharing">
  <a href="https://twitter.com/share" class="twitter-share-button" data-url="https://FairyOnIce.github.io/mahalanobis-tf2-full.html" data-via="" data-counturl="https://FairyOnIce.github.io/mahalanobis-tf2-full.html" >Tweet</a>
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
</div>    </footer>
  </article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://yumis-blog.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
     
    </section>
</div>
<aside class="sidebar">

<section>
    <h1>Local Search</h1></hr>
    <form class="navbar-search" action="https://FairyOnIce.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="" name="q" id="tipue_search_input"><input type="submit" value="Go!"></form></li>
</section>
    
<section>

    <h1>Recent Posts</h1>
    <ul id="recent_posts">
      <li class="post">
          <a href="https://FairyOnIce.github.io/multidimensional-indexing-with-tensorflow.ipynb.html">Multidimensional indexing with tensorflow</a>
      </li>
      <li class="post">
          <a href="https://FairyOnIce.github.io/mahalanobis-tf2-full.html">Classification with Mahalanobis distance + full covariance using tensorflow</a>
      </li>
      <li class="post">
          <a href="https://FairyOnIce.github.io/mahalanobis-tf2.html">Calculate Mahalanobis distance with tensorflow 2.0</a>
      </li>
      <li class="post">
          <a href="https://FairyOnIce.github.io/sample-size-finite-population-fake-account.html">Sample size calculation to predict proportion of fake accounts in social media</a>
      </li>
      <li class="post">
          <a href="https://FairyOnIce.github.io/Gentle-Hands-on-Introduction-to-Observational-Study.html">Gentle Hands-on Introduction to Propensity Score Matching</a>
      </li>
    </ul>
  </section>
  <section>
      
    <h1>Categories</h1>
    <ul id="recent_posts">
        <li><a href="https://FairyOnIce.github.io/category/blog.html">Blog</a></li>
    </ul>
  </section>
 

  <section>
  <h1>Tags</h1>
    <a href="https://FairyOnIce.github.io/tag/bleu.html">BLEU</a>,    <a href="https://FairyOnIce.github.io/tag/spectrogram.html">Spectrogram</a>,    <a href="https://FairyOnIce.github.io/tag/statistics.html">statistics</a>,    <a href="https://FairyOnIce.github.io/tag/nlp.html">NLP</a>,    <a href="https://FairyOnIce.github.io/tag/object-detection-using-yolov2-on-pascal-voc2012-series.html">Object Detection using YOLOv2 on Pascal VOC2012 series</a>,    <a href="https://FairyOnIce.github.io/tag/api.html">API</a>,    <a href="https://FairyOnIce.github.io/tag/pascal-voc2012.html">PASCAL VOC2012</a>,    <a href="https://FairyOnIce.github.io/tag/object-detection-using-rcnn-on-pascal-voc2012-series.html">Object Detection using RCNN on Pascal VOC2012 series</a>,    <a href="https://FairyOnIce.github.io/tag/gps-watch.html">GPS watch</a>,    <a href="https://FairyOnIce.github.io/tag/deep-learning.html">deep learning</a>,    <a href="https://FairyOnIce.github.io/tag/celeba.html">CelebA</a>,    <a href="https://FairyOnIce.github.io/tag/heroku.html">Heroku</a>,    <a href="https://FairyOnIce.github.io/tag/computer-vision.html">Computer Vision</a>,    <a href="https://FairyOnIce.github.io/tag/game.html">Game</a>,    <a href="https://FairyOnIce.github.io/tag/object-detection.html">Object Detection</a>,    <a href="https://FairyOnIce.github.io/tag/interview.html">interview</a>,    <a href="https://FairyOnIce.github.io/tag/tensorflow.html">TensorFlow</a>,    <a href="https://FairyOnIce.github.io/tag/model.html">Model</a>,    <a href="https://FairyOnIce.github.io/tag/natural-language-processing.html">Natural Language Processing</a>,    <a href="https://FairyOnIce.github.io/tag/fourier-transform.html">Fourier Transform</a>  </section>


    <section>
        <h1>Social</h1>
        <ul>
            <li><a href="https://www.linkedin.com/notifications/" target="_blank">LinkedIn</a></li>
            <li><a href="https://github.com/FairyOnIce" target="_blank">Github</a></li>
        </ul>
    </section>
    <section>
        <h1>Blogroll</h1>
        <ul>
            <li><a href="https://getpelican.com/" target="_blank">Pelican</a></li>
            <li><a href="https://python.org/" target="_blank">Python.org</a></li>
        </ul>
    </section>

</aside>    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Yumi -
  <span class="credit">Powered by <a href="https://getpelican.com">Pelican</a></span>
</p></footer>
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-112020731-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'https://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-112020731-1');
    ga('send', 'pageview');
</script>
	<script type="text/javascript">
	  var disqus_shortname = 'yumis-blog';
          var disqus_identifier = '/mahalanobis-tf2-full.html';
          var disqus_url = 'https://FairyOnIce.github.io/mahalanobis-tf2-full.html';
          var disqus_title = 'Classification with Mahalanobis distance + full covariance using tensorflow';
	  (function() {
	    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
	    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	   })();
	</script>
  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'https://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
</body>
</html>